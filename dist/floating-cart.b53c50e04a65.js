!function(){"use strict";function t(t){const n=v(document.cookie,"; ").find(n=>{const{name:a}=e(n);return a===t});return!!n&&e(n).value}function e(t){const[e,...n]=v(t,"=");return{name:e,value:y(n)>0&&decodeURIComponent(n.join("="))}}var n="carrinhoflutuante--visible",a="__Host-cc-AuthToken",r="__Host-Cc-Session-Cookie",i="X-Cc-Session";function o(t){const e=t?.headers.get(i);e&&function(t,e,n={}){if(0===y(t))throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof e)||0===y(e.toString()))throw new Error("'setCookie' should receive a valid cookie value");const a=[`${t}=${encodeURIComponent(e)}`];n?.expires&&n?.expires instanceof Date&&a.push("expires="+n.expires.toUTCString()),n.maxAge&&a.push(`maxAge=${n.maxAge}`),n?.sameSite&&"string"==typeof n?.sameSite&&a.push(`SameSite=${n?.sameSite}`),n?.path&&a.push(`path=${n?.path}`),n?.domain&&a.push(`domain=${n?.domain}`),n?.httpOnly&&a.push("HttpOnly"),n?.secure&&a.push("Secure");const r=a.join("; ");document.cookie=r}(r,e,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+12096e5)})}function c(t,e=!1,n){return o(this),e||this&&401===this.status&&(location.href=function(t,e={}){const n=new URL(`${location.protocol}//${location.hostname}`),a=new URL(t,n);for(const[r,i]of Object.entries(e))a.searchParams.set(r,i);return a.toString()}("/log-in",{redirect_to:encodeURIComponent(location.pathname+location.search)})),n?.(),{message:t,succeeded:!1}}function s(t,e){return o(this),e?.(),{data:t,succeeded:!0}}function u(e=[],n="GET"){const o="application/json",c=new Headers({Accept:o,"Content-Type":o});for(const[t,a]of e)c.set(t,a);const s=t(r);s&&c.set(i,s);const u=t(a);return u&&c.set("Authorization",u),{method:n,headers:c}}var f=null,l="oculto";function d(t,e=document){return e?e.querySelector(t):f}function p(t,e,n,a){if(t)return t.addEventListener(e,n,a),()=>t.removeEventListener(e,n,a)}function h(t,...e){t&&t.classList.add(...e)}function g(t,...e){t&&t.classList.remove(...e)}function m(t,e,n){return!!t&&t.classList.toggle(e,n)}function w(t,e){t&&(t.textContent="string"==typeof e?e:e.toString())}function y(t){return t.length}function v(t,e,n){return t.split(e,n)}var b=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function k(t,e=0){const n=Math.pow(10,e);return Math.round(t*n)/n}var _="increase";function C(){return!1!==t(a)?"user":"guest"}var S="price",P="full_price",$=d("#carrinho-flutuante");if(!$)throw new Error("Could not find floating cart");var x="https://xef5-44zo-gegm.b2.xano.io/api:b9-USIEf",O={cart:f,fetched:f,isPending:!1,isCartOpened:!0,shippingPrice:f},j=d("[data-wtf-floating-cart-item]"),A=d("[data-wtf-floating-cart-item-wrapper]"),E=d("[data-wtf-floating-cart-empty-cart]"),L=d("[data-wtf-floating-cart-total]"),R=new Proxy(O,{get:(t,e)=>Reflect.get(t,e),set(t,e,n){const a=Reflect.set(t,e,n);switch(e){case"isCartOpened":H();break;case"cart":!function(){const{cart:t}=R;if(!t)return;const{items:e,cart_items:n,is_subscriber:a=!1}=t;if(!function(t){return Array.isArray(t)}(e)||!j||!A)return;const r=0===n;if(m(L,l,r),m(d("[data-wtf-floating-cart-checkout-button]",$),l,r),m(d("[data-wtf-floating-cart-total-block]"),l,r),!m(E,l,!r))return w(d("[data-wtf-floating-cart-items-indicator]"),n),A.replaceChildren();const i=document.createDocumentFragment(),o=U(t,a);for(const{slug:c,image_url:s,quantity:u,price:f,full_price:l,name:g,sku_id:m}of e){const t=j.cloneNode(!0);I({price:f,full_price:l},t,o),w(d("[data-wtf-floating-cart-item-product-name]",t),g),w(d("[data-wtf-floating-cart-item-quantity]",t),u);const e=d("[data-wtf-floating-cart-item-image]",t);e&&(e.style.backgroundImage=`url('${s}')`);const n={sku_id:m,reference_id:c},a=[["delete","data-wtf-floating-cart-item-remove"],[_,"data-wtf-floating-cart-item-plus-button"],["decrease","data-wtf-floating-cart-item-minus-button"]];for(const[r,i]of a){const e=d(`[${i}]`,t);r===_&&u>=10?h(e,"onedge"):p(e,"click",t=>M.call(t,r,n))}i.appendChild(t)}w(d("[data-wtf-floating-cart-items-indicator]"),n),A?.replaceChildren(i)}(),async function(){const t=localStorage.getItem("contra_corrente_cep"),e=d("[data-wtf-floating-cart-shipping-wrapper]");if(!t)return void h(e,l);const n=await async function(t){const e="Houve uma falha durante a captura do preÃ§o de entrega";try{const n=await fetch(`${x}/cart/delivery-price?cep=${t}`,{...u(),priority:"high"});if(!n.ok){const t=await n.json();return c.call(n,t?.message??e)}const a=await n.json();return s.call(n,a)}catch(n){return c(e)}}(t);n.succeeded?(R.shippingPrice=n.data.pcFinal,g(e,l),w(d("[data-wtf-floating-cart-shipping-price]"),b.format(k(R.shippingPrice/100,2)))):h(e,l)}(),U(t.cart,t.cart?.is_subscriber??!1);break;case"shippingPrice":U(t.cart,t.cart?.is_subscriber??!1)}return a}});async function H(){if(!R.isCartOpened||R.isPending)return;R.isPending=!0;const t=await async function(){const t="Houve uma falha ao buscar o seu carrinho",e=C();try{const n=await fetch(`${x}/cart/get/${e}`,{...u(),priority:"high"});if(!n.ok){const e=await n.json();return c.call(n,e?.message??t)}const a=await n.json();return s.call(n,a)}catch(n){return c(t)}}();R.fetched??=!0,R.isPending=!1,t.succeeded&&(R.cart=t.data)}function I(t,e,n=!1){const a=d("[data-wtf-floating-cart-item-product-price-original]",e),r=d("[data-wtf-floating-cart-item-product-price]",e);let i=0,o=0;switch(n){case!1:case S:[i,o]=[t[S],t[P]];break;case P:{const e=Math.max(.7,0);[i,o]=[Math.round(t[P]*e),t[P]]}}const c=i!==o;if(w(r,b.format(k(i/100,2))),!c)return h(a,l);w(a,b.format(k(o/100,2)))}function U(t,e){const n=e&&function(t){const e=t.reduce((t,e)=>(t[S]+=e[S],t[P]+=.7*e[P],t),{[S]:0,[P]:0});return e[S]===e[P]||e[P]>e[S]?S:P}(t.items.map(({price:t,full_price:e})=>({price:t,full_price:e})));let a=0;switch(n){case!1:case S:a=t.order_price;break;case P:a=Math.round(.7*t.order_full_price)}return a+=R.shippingPrice??0,w(L,b.format(k(a/100,2))),n}async function M(t,e){this.preventDefault(),this.stopPropagation(),await async function(t,e){if(R.isPending)return;R.isPending=!0;const n=await async function(t,e){const n="Houve uma falha ao buscar o seu carrinho",a=C();try{const i=await fetch(`${x}/cart/handle/${a}`,{...u([],"POST"),priority:"high",keepalive:!0,body:(r={item:t,operation:e},JSON.stringify(r))});if(!i.ok){const t=await i.json();return c.call(i,t?.message??n)}const o=await i.json();return s.call(i,o)}catch(i){return c(n)}var r}({...e,quantity:1},t);R.isPending=!1,n.succeeded&&(R.cart=n.data)}(t,e)}if(new MutationObserver(t=>{const e=t[0].target,a=(i=n,!!(r=e)&&r.classList.contains(i));var r,i;R.isCartOpened!==a&&(R.isCartOpened=a,window.scrollTo({top:0,behavior:"instant"}),document.body.style.overflow=a?"hidden":"unset")}).observe($,{attributes:!0,attributeFilter:["class"]}),!A)throw new Error("Product wrapper is missing");document.querySelectorAll("[data-wtf-botao-carrinho-flutuante]").forEach(t=>{p(t,"click",()=>m($,n),{passive:!0})}),H().then(()=>{R.isCartOpened=!1,g($,l)})}();