!function(){"use strict";var e="POST",t="https://xef5-44zo-gegm.b2.xano.io";function n(e,t,n){return e?t.push(n):-1}function i(e){const t=_(document.cookie,"; ").find(t=>{const{name:n}=r(t);return n===e});return!!t&&r(t).value}function r(e){const[t,...n]=_(e,"=");return{name:t,value:C(n)>0&&decodeURIComponent(n.join("="))}}var a="__Host-cc-AuthToken",o="__Host-Cc-Session-Cookie",s="X-Cc-Session";function c(e){const t=e?.headers.get(s);t&&function(e,t,n={}){if(0===C(e))throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof t)||0===C(t.toString()))throw new Error("'setCookie' should receive a valid cookie value");const i=[`${e}=${encodeURIComponent(t)}`];n?.expires&&n?.expires instanceof Date&&i.push("expires="+n.expires.toUTCString()),n.maxAge&&i.push(`maxAge=${n.maxAge}`),n?.sameSite&&"string"==typeof n?.sameSite&&i.push(`SameSite=${n?.sameSite}`),n?.path&&i.push(`path=${n?.path}`),n?.domain&&i.push(`domain=${n?.domain}`),n?.httpOnly&&i.push("HttpOnly"),n?.secure&&i.push("Secure");const r=i.join("; ");document.cookie=r}(o,t,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+12096e5)})}function u(e,t=!1,n){return c(this),t||this&&401===this.status&&(location.href=k("/log-in",{redirect_to:encodeURIComponent(location.pathname+location.search)})),n?.(),{message:e,succeeded:!1}}function d(e,t){return c(this),t?.(),{data:e,succeeded:!0}}function l(e=[],t="GET"){const n="application/json",r=new Headers({Accept:n,"Content-Type":n});for(const[i,a]of e)r.set(i,a);const c=i(o);c&&r.set(s,c);const u=i(a);return u&&r.set("Authorization",u),{method:t,headers:r}}var f=null,p="oculto";function h(e,t=document){return t?t.querySelector(e):f}function m(e,t,n,i){if(e)return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function g(e,...t){e&&e.classList.add(...t)}function y(e,...t){e&&e.classList.remove(...t)}function w(e,t,n){return!!e&&e.classList.toggle(t,n)}function v(e,t){e&&(e.textContent="string"==typeof t?t:t.toString())}function k(e,t={}){const n=new URL(`${location.protocol}//${location.hostname}`),i=new URL(e,n);for(const[r,a]of Object.entries(t))i.searchParams.set(r,a);return i.toString()}function S(e){return JSON.stringify(e)}function b(e){return e.replace(/\D+/g,"")}function C(e){return e.length}function P(){return/^\d{5}-\d{3}$/}function _(e,t,n){return e.split(t,n)}function E(e){return e===f}var L=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function I(e,t,n){return Math.max(e,Math.min(t,n))}var q={PRICE:"price",FULL_PRICE:"full_price"};function R(){return!1!==i(a)?"user":"guest"}var $=location.pathname.split("/").at(-1);if(!$)throw new Error("Slug do produto não foi encontrado");var U=h("[data-sku-selector]");if(!U)throw new Error("Impossível realizar a seleção de SKUs");var x="high",D="strikethrough",j=U.parentElement,T=h("[data-wtf-sku-price]"),F=h("[data-wtf-sku-full-price]"),H=h("[data-wtf-trigger-add-cep]"),M=h("#spp-calculo-do-cep"),O=h("#spp-campo-de-cep"),A=h("#spp-mensagem-de-erro-campo-de-cep"),N=h("#spp-custo-do-frete-bloco"),B=h("#spp-custo-do-frete");h("[data-wtf-subscriber-view-price]");var z=h("#spp-custo-do-frete-mudar-cep");m(h("[data-wtf-quantity-minus]"),"click",e=>{X(-1)}),m(h("[data-wtf-quantity-plus]"),"click",e=>{X(1)}),m(H,"click",e=>{w(h("[data-wtf-trigger-add-cep-container]"),p,!0),y(M,p)}),m(O,"input",async e=>{if(!e.isTrusted)return;const t=e.target;if(!(t instanceof HTMLInputElement))return;const i=b(t.value).replace(/^(\d{0,5})(\d{0,3})/,(e,t,i)=>{const r=[];for(const a of[t,i])n(a,r,a);return r.join("-")});var r,a;t.value=i,K.shippingCEP=(a=i,("function"==typeof(r=P)?r():r).test(a)?b(i):f)}),m(h("[data-wtf-buy-now]"),"click",async e=>{e.isTrusted&&await G(!0)}),m(h("[data-wtf-add-to-cart]"),"click",async e=>{e.isTrusted&&await G()});var K=new Proxy({selectedSku:f,shippingCEP:f,quantity:1,isSubscriber:!1,skus:[],isDeliveryLoading:!1,deliveryPrice:f,isManipulatingCart:!1},{get(e,t){switch(t){case q.PRICE:case q.FULL_PRICE:{const e=W();return e?e[t]/100:0}case"singleItemPrice":{const t=W();if(!t)return 0;const{[q.PRICE]:n,[q.FULL_PRICE]:i}=t,r=I(0,1,.7);return e.isSubscriber?J(i,n)?n:i*r:n}case"final_price":{const{quantity:t,deliveryPrice:n}=e,i=n??0;return(K.singleItemPrice*t+i)/100}case"hasSamePrices":{const e=W();return!!e&&e[q.PRICE]===e[q.FULL_PRICE]}}return Reflect.get(e,t)},set(e,t,n){const i=Reflect.set(e,t,n);switch(t){case"selectedSku":!function(){const e=document.createDocumentFragment();for(const t of K.skus){const n=U.cloneNode(!0),i=t.sku_id===K.selectedSku;v(n,t.variation_type),w(n,"selecionado",i),m(n,"click",e=>{e.preventDefault(),e.stopPropagation(),i||(K.selectedSku=t.sku_id,1!==K.quantity&&(K.quantity=1))}),e.appendChild(n)}j.replaceChildren(e)}(),function(){const{price:e,full_price:t,isSubscriber:n,hasSamePrices:i,singleItemPrice:r}=K;v(T,L.format(e)),v(F,L.format(i?0:t));const a=J(t,e),o=w(h("[data-wtf-full-price-view]"),p,n&&i);w(T,D,n&&a),w(h("[data-wtf-price-view]"),p,n&&(!i||a)),w(T,D,n&&o),w(h("[data-wtf-subscriber-view-price]"),p,!n),v(h("[data-wtf-sku-subscriber-price]"),L.format(r/100))}(),Q();break;case"quantity":{v(h("[data-wtf-quantity-value]"),K.quantity),Q();const{shippingCEP:t}=e;E(t)||8!==C(t)||Y()}break;case"shippingCEP":Y();break;case"isDeliveryLoading":break;case"deliveryPrice":y(N,p),v(B,L.format(n/100)),m(z,"click",e=>{e.isTrusted&&V()},{once:!0}),Q();break;case"isSubscriber":Q()}return i}});async function G(n){if(K.isManipulatingCart)return;K.isManipulatingCart=!0;const{quantity:i,selectedSku:r}=K;if(!r)throw new Error("Nenhum SKU foi selecionado");const a=await async function(n){const i="Houve uma falha na adição do produto",r=R();try{const a=await fetch(`${t}/api:b9-USIEf/cart/handle/${r}`,{...l([],e),body:S(n),priority:x,keepalive:!0});if(!a.ok){const e=await a.json();return u.call(a,e?.message??i)}const o=await a.json();return d.call(a,o)}catch(a){return u(i)}}({item:{quantity:i,sku_id:r,reference_id:$},operation:"add",...n&&{immediate:n}});if(K.isManipulatingCart=!1,!a.succeeded)return alert(a.message??"Não foi possível adicionar o produto no seu carrinho");K.quantity=1,g(h("#carrinho-flutuante"),"carrinhoflutuante--visible"),localStorage.setItem("editora_contracorrente_cart_items",S(a.data))}function J(e,t){return e*I(0,1,.7)>=t}function X(e){if(K.isDeliveryLoading)return;const t=W();if(!t)throw new Error("SKU was not specified");const n=I(1,10,I(1,K.quantity+e,t.inventory));n!==K.quantity&&(K.quantity=n)}function Q(){v(h("[data-wtf-sku-final-price]"),L.format(K.final_price))}function V(){O&&(O.value=""),K.shippingCEP=f,K.deliveryPrice=f,g(A,p),y(M,p),g(N,p),v(B,L.format(0))}function W(){const{skus:e,selectedSku:t}=K;return e.find(e=>t===e.sku_id)}async function Y(){if(K.isDeliveryLoading)return;const{quantity:n,shippingCEP:i}=K;if(E(i)||!$)throw new Error("Invalid parameters provided to `getDeliveryInfo` function");const r=await async function(n){const i="Houve uma falha ao buscar os dados de entrega";K.isDeliveryLoading=!0;try{const r=await fetch(`${t}/api:_4BO6C7F/delivery-price`,{...l([],e),priority:x,body:S(n)});if(!r.ok){const e=await r.json();return u.call(r,e?.message??i,!0)}const a=await r.json();return d.call(r,a)}catch(r){return u(i)}finally{K.isDeliveryLoading=!1}}({quantity:n,cep:i,product_slug:$});if(g(M,p),!r.succeeded)return navigator.vibrate?.([50,20,50]),v(A,r.message),y(A,p),setTimeout(V,4e3);K.deliveryPrice=r.data.pcFinal}Promise.allSettled([async function(e){const n="Houve uma falha ao buscar os dados do usuário",i=R();try{const r=await fetch(`${t}/api:_4BO6C7F/product/${e}/${i}`,{...l(),priority:x});if(!r.ok){const e=await r.json();return u.call(r,e?.message??n,!0)}const a=await r.json();return d.call(r,a)}catch(r){return u(n)}}($).then(function(e){e.succeeded?(K.isSubscriber=e.data.is_subscriber??!1,K.skus=e.data.skus,K.selectedSku=e.data.skus.at(0)?.sku_id??f):location.href=k("/",{reason:"product_not_founded"})})]),window.addEventListener("pageshow",e=>{e.persisted&&location.reload()})}();